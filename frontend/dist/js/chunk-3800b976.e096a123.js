(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3800b976"],{"379b":function(t,e,n){},"45a3":function(t,e,n){},4917:function(t,e,n){"use strict";var o=n("cb7c"),i=n("9def"),s=n("0390"),r=n("5f1b");n("214f")("match",1,function(t,e,n,a){return[function(n){var o=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,o):new RegExp(n)[e](String(o))},function(t){var e=a(n,t,this);if(e.done)return e.value;var c=o(t),l=String(this);if(!c.global)return r(c,l);var u=c.unicode;c.lastIndex=0;var d,f=[],h=0;while(null!==(d=r(c,l))){var v=String(d[0]);f[h]=v,""===v&&(c.lastIndex=s(l,i(c.lastIndex),u)),h++}return 0===h?null:f}]})},"4f7f":function(t,e,n){"use strict";var o=n("c26b"),i=n("b39a"),s="Set";t.exports=n("e0b8")(s,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(i(this,s),t=0===t?0:t,t)}},o)},5016:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("menu-tooltip",{staticClass:"select_button",class:{"select_button--touch":!t.touchDisabled},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}},[n("template",{slot:"button"},[t.options.length?n("div",{staticClass:"button button--thin_text",class:{"select_button__button--selected":t.menuOpen},on:{click:function(e){t.menuOpen=!0}}},[t._v("\n\t\t\t"+t._s(t.options[t.selectedIndex].name)+"\n\t\t\t"),n("span",{staticClass:"button__icon select_button__icon fa fa-fw fa-chevron-down"})]):n("div",{staticClass:"button"},[t._v("\n\t\t\tNo options\n\t\t")])]),n("template",{slot:"menu"},t._l(t.options,function(e,o){return n("div",{staticClass:"select_button__option",class:{"select_button__option--disabled":e.disabled,"select_button__option--selected":o===t.selectedIndex&&!e.disabled},on:{click:function(n){t.select(o,e.disabled)}}},[t._v("\n\t\t\t"+t._s(e.name)+"\n\t\t")])}),0)],2)},i=[],s=(n("ac6a"),n("6fab")),r={name:"SelectButton",props:["options","value","name","touch-disabled"],components:{MenuTooltip:s["a"]},methods:{select:function(t,e){e||(this.selectedIndex=t,this.menuOpen=!1,this.$emit("input",this.options[t].value))},getIndexFromValue:function(){var t=0,e=this;return null!==this.value&&this.options.forEach(function(n,o){n.value===e.value&&(t=o)}),t}},data:function(){return{selectedIndex:this.getIndexFromValue(),menuOpen:!1}},watch:{value:function(){this.selectedIndex=this.getIndexFromValue()}}},a=r,c=(n("ee60"),n("2877")),l=Object(c["a"])(a,o,i,!1,null,"3a8a48fc",null);l.options.__file="SelectButton.vue";e["a"]=l.exports},"508c":function(t,e,n){},"67ab":function(t,e,n){var o=n("ca5a")("meta"),i=n("d3f4"),s=n("69a8"),r=n("86cc").f,a=0,c=Object.isExtensible||function(){return!0},l=!n("79e5")(function(){return c(Object.preventExtensions({}))}),u=function(t){r(t,o,{value:{i:"O"+ ++a,w:{}}})},d=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,o)){if(!c(t))return"F";if(!e)return"E";u(t)}return t[o].i},f=function(t,e){if(!s(t,o)){if(!c(t))return!0;if(!e)return!1;u(t)}return t[o].w},h=function(t){return l&&v.NEED&&c(t)&&!s(t,o)&&u(t),t},v=t.exports={KEY:o,NEED:!1,fastKey:d,getWeak:f,onFreeze:h}},"6e0b":function(t,e,n){"use strict";var o=n("c89d"),i=n.n(o);i.a},"6fab":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu_tooltip",class:{"menu_tooltip--touch":!t.touchDisabled}},[n("div",{staticClass:"menu_tooltip__overlay",class:{"menu_tooltip__overlay--show":t.value},on:{click:function(e){t.$emit("input",!1)}}}),t._t("button"),n("div",{staticClass:"menu_tooltip__menu",class:{"menu_tooltip__menu--show":t.value},style:{top:t.top,width:t.width}},[n("div",{staticClass:"menu_tooltip__menu__inner"},[t._t("menu")],2)])],2)},i=[],s=(n("cadf"),n("551c"),n("097d"),{name:"MenuTooltip",props:["value","top","width","touch-disabled"]}),r=s,a=(n("6e0b"),n("2877")),c=Object(a["a"])(r,o,i,!1,null,"5bd61e2c",null);c.options.__file="MenuTooltip.vue";e["a"]=c.exports},"87e6":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input_editor_core"},[n("div",[n("div",{staticClass:"input_editor_core__format_bar"},[n("div",{staticClass:"input_editor_core__format_button",attrs:{title:"Bold (ctrl + b)"},on:{click:function(e){t.replaceSelectedText("__","__")}}},[t._v("\n\t\t\t\tB\n\t\t\t")]),n("div",{staticClass:"input_editor_core__format_button",attrs:{title:"Italic (ctrl + i)"},on:{click:function(e){t.replaceSelectedText("*","*")}}},[t._v("\tI\n\t\t\t")]),n("div",{staticClass:"input_editor_core__format_button",attrs:{title:"Link (ctrl + l)"},on:{click:function(e){t.setModalState("link",!0)}}},[n("span",{staticClass:"fa fa-link"})])]),n("textarea",{ref:"textarea",staticClass:"input_editor_core__input",attrs:{placeholder:"Type here"},domProps:{value:t.value},on:{input:function(e){t.setEditor(e.target.value)},focus:function(e){t.$emit("focus")},blur:function(e){t.$emit("blur")},keydown:[function(e){return("button"in e||66===e.keyCode)&&e.ctrlKey?(e.preventDefault(),void t.replaceSelectedText("__","__")):null},function(e){return("button"in e||73===e.keyCode)&&e.ctrlKey?(e.preventDefault(),void t.replaceSelectedText("*","*")):null},function(e){return("button"in e||76===e.keyCode)&&e.ctrlKey?(e.preventDefault(),void t.setModalState("link",!0)):null}]}})]),n("modal-window",{model:{value:t.linkModalVisible,callback:function(e){t.linkModalVisible=e},expression:"linkModalVisible"}},[n("div",{attrs:{slot:"main"},slot:"main"},[n("p",[t._v("\n\t\t\t\tEnter the web address in the input box below\n\t\t\t")]),n("fancy-input",{attrs:{placeholder:"Text for link",width:"100%"},model:{value:t.linkText,callback:function(e){t.linkText=e},expression:"linkText"}}),n("fancy-input",{attrs:{placeholder:"Web address for link",width:"100%"},model:{value:t.linkURL,callback:function(e){t.linkURL=e},expression:"linkURL"}})],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("button",{staticClass:"button button--green button--modal",on:{click:t.addLink}},[t._v("\n\t\t\t\tAdd link\n\t\t\t")]),n("button",{staticClass:"button button--modal",on:{click:function(e){t.setModalState("link",!1)}}},[t._v("\n\t\t\t\tCancel\n\t\t\t")])])])],1)},i=[],s=(n("4917"),n("ac6a"),n("cadf"),n("551c"),n("097d"),n("6307")),r=n("80e3"),a=(n("6334"),n("e145")),c={},l={name:"InputEditorCore",props:["value","error"],components:{ModalWindow:s["a"],FancyInput:r["a"],ErrorTooltip:a["a"]},data:function(){return{linkText:"",linkURL:"",linkModalVisible:!1,imageModalVisible:!1}},methods:{setModalState:function(t,e){"link"===t?(this.linkModalVisible=e,e?this.linkText=this.getSelectionData().val:(this.linkText="",this.linkURL="")):"image"===t&&(this.imageModalVisible=e)},checkUsernames:function(t){var e=this,n=0,o=[],i=function(i){n++,i&&o.push(i),n===t.length&&e.$emit("mentions",o)};t.forEach(function(t){e.checkUsername(t,i)})},checkUsername:function(t,e){var n=t.trim().slice(1),o=c[n];void 0!==o?e(o):void 0===o&&this.axios.get("/api/v1/user/"+n).then(function(t){c[n]=n,e(n)}).catch(function(t){c[n]=null,e(null)})},setEditor:function(t){var e=t.match(/(^|\s)@[^\s]+/g)||[];this.checkUsernames(e),this.$emit("input",t)},getSelectionData:function(){var t=this.$refs.textarea,e=t.selectionStart,n=t.selectionEnd;return{val:t.value.slice(e,n),start:e,end:n}},replaceSelectedText:function(t,e){var n=this.getSelectionData(),o=this.$refs.textarea;this.value.substr(n.start-t.length,t.length)===t&&this.value.substr(n.end,e.length)===e?(this.setEditor(this.value.slice(0,n.start-t.length)+n.val+this.value.slice(n.end+e.length)),setTimeout(function(){o.selectionStart=n.start-t.length,o.selectionEnd=n.end-e.length},0)):(this.setEditor(this.value.slice(0,n.start)+t+n.val+e+this.value.slice(n.end)),setTimeout(function(){o.selectionStart=n.start+t.length,o.selectionEnd=n.end+e.length},0)),o.focus()}}},u=l,d=(n("aaa0"),n("2877")),f=Object(d["a"])(u,o,i,!1,null,"435529b0",null);f.options.__file="InputEditorCore.vue";e["a"]=f.exports},aaa0:function(t,e,n){"use strict";var o=n("379b"),i=n.n(o);i.a},b39a:function(t,e,n){var o=n("d3f4");t.exports=function(t,e){if(!o(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},bd28:function(t,e,n){"use strict";var o=n("bc3a"),i=n.n(o);e["a"]=function(t,e){"userPosts"===t||"userThreads"===t?i.a.get("/api/v1/user/"+e).then(function(e){return i.a.post("/api/v1/log",{route:t,resourceId:e.data.id})}).catch(console.log):i.a.post("/api/v1/log",{route:t,resourceId:e}).catch(console.log)}},c26b:function(t,e,n){"use strict";var o=n("86cc").f,i=n("2aeb"),s=n("dcbc"),r=n("9b43"),a=n("f605"),c=n("4a59"),l=n("01f9"),u=n("d53b"),d=n("7a56"),f=n("9e1e"),h=n("67ab").fastKey,v=n("b39a"),p=f?"_s":"size",_=function(t,e){var n,o=h(e);if("F"!==o)return t._i[o];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var u=t(function(t,o){a(t,u,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[p]=0,void 0!=o&&c(o,n,t[l],t)});return s(u.prototype,{clear:function(){for(var t=v(this,e),n=t._i,o=t._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete n[o.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var n=v(this,e),o=_(n,t);if(o){var i=o.n,s=o.p;delete n._i[o.i],o.r=!0,s&&(s.n=i),i&&(i.p=s),n._f==o&&(n._f=i),n._l==o&&(n._l=s),n[p]--}return!!o},forEach:function(t){v(this,e);var n,o=r(t,arguments.length>1?arguments[1]:void 0,3);while(n=n?n.n:this._f){o(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function(t){return!!_(v(this,e),t)}}),f&&o(u.prototype,"size",{get:function(){return v(this,e)[p]}}),u},def:function(t,e,n){var o,i,s=_(t,e);return s?s.v=n:(t._l=s={i:i=h(e,!0),k:e,v:n,p:o=t._l,n:void 0,r:!1},t._f||(t._f=s),o&&(o.n=s),t[p]++,"F"!==i&&(t._i[i]=s)),t},getEntry:_,setStrong:function(t,e,n){l(t,e,function(t,n){this._t=v(t,e),this._k=n,this._l=void 0},function(){var t=this,e=t._k,n=t._l;while(n&&n.r)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?u(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,u(1))},n?"entries":"values",!n,!0),d(e)}}},c89d:function(t,e,n){},e0b8:function(t,e,n){"use strict";var o=n("7726"),i=n("5ca1"),s=n("2aba"),r=n("dcbc"),a=n("67ab"),c=n("4a59"),l=n("f605"),u=n("d3f4"),d=n("79e5"),f=n("5cc5"),h=n("7f20"),v=n("5dbc");t.exports=function(t,e,n,p,_,m){var b=o[t],g=b,k=_?"set":"add",w=g&&g.prototype,y={},x=function(t){var e=w[t];s(w,t,"delete"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof g&&(m||w.forEach&&!d(function(){(new g).entries().next()}))){var C=new g,F=C[k](m?{}:-0,1)!=C,$=d(function(){C.has(1)}),j=f(function(t){new g(t)}),T=!m&&d(function(){var t=new g,e=5;while(e--)t[k](e,e);return!t.has(-0)});j||(g=e(function(e,n){l(e,g,t);var o=v(new b,e,g);return void 0!=n&&c(n,_,o[k],o),o}),g.prototype=w,w.constructor=g),($||T)&&(x("delete"),x("has"),_&&x("get")),(T||F)&&x(k),m&&w.clear&&delete w.clear}else g=p.getConstructor(e,t,_,k),r(g.prototype,n),a.NEED=!0;return h(g,t),y[t]=g,i(i.G+i.W+i.F*(g!=b),y),m||p.setStrong(g,t,_),g}},e3ed:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"route_container thread_new"},[n("div",{staticClass:"h1"},[t._v("Post new thread")]),n("div",{staticClass:"thread_meta_info"},[n("div",{staticClass:"thread_meta_info__text"},[t._v("Enter the thread title and the category to post it in")]),n("div",{staticClass:"thread_meta_info__form"},[n("select-button",{attrs:{options:t.categories},model:{value:t.selectedCategory,callback:function(e){t.selectedCategory=e},expression:"selectedCategory"}}),n("fancy-input",{staticClass:"thread_meta_info__title",attrs:{placeholder:"Thread title",error:t.errors.name,large:"true",width:"15rem"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)]),n("div",{staticClass:"editor",class:{"editor--focus":t.focusInput,"editor--error":t.errors.content}},[n("div",{staticClass:"editor__input"},[n("div",{staticClass:"editor__format_bar editor__format_bar--editor"},[t._v("\n\t\t\t\teditor\n\t\t\t")]),n("input-editor-core",{on:{mentions:t.setMentions,focus:function(e){t.setFocusInput(!0)},blur:function(e){t.setFocusInput(!1)}},model:{value:t.editor,callback:function(e){t.editor=e},expression:"editor"}})],1)]),n("error-tooltip",{staticClass:"editor_error",attrs:{error:t.errors.content}}),n("loading-button",{staticClass:"button--green submit",attrs:{loading:t.loading},on:{click:t.postThread}},[t._v("Post thread")])],1)},i=[],s=(n("5df3"),n("4f7f"),n("7f7f"),n("ac6a"),n("cadf"),n("551c"),n("097d"),n("87e6")),r=n("80e3"),a=n("5016"),c=n("8e8d"),l=n("e145"),u=n("c4b0"),d=n("bd28"),f={name:"ThreadNew",components:{InputEditorCore:s["a"],SelectButton:a["a"],FancyInput:r["a"],LoadingButton:c["a"],ErrorTooltip:l["a"]},data:function(){return{selectedCategory:this.$store.state.category.selectedCategory,editor:"",mentions:[],name:"",loading:!1,focusInput:!1,errors:{content:"",name:""}}},computed:{categories:function(){return this.$store.getters.categoriesWithoutAll}},methods:{setErrors:function(t){var e=this;t.forEach(function(t){e.errors[t.name]=t.error})},clearErrors:function(){this.errors.content="",this.errors.name=""},hasDuplicates:function(t,e){return e&&(t=t.map(e)),t.length!==new Set(t).size},postThread:function(){var t,e=this,n=[];this.clearErrors(),this.editor.trim().length||n.push({name:"content",error:"Post content cannot be blank"}),this.name.trim().length||n.push({name:"name",error:"Cannot be blank"}),n.length?this.setErrors(n):(this.loading=!0,this.axios.post("/api/v1/thread",{name:this.name,category:this.selectedCategory}).then(function(n){t=n.data;var o=[];return o.push(e.axios.post("/api/v1/post",{threadId:n.data.id,content:e.editor,mentions:e.mentions})),Promise.all(o)}).then(function(n){e.loading=!1,e.$router.push("/thread/".concat(t.slug,"/").concat(t.id,"/0"))}).catch(function(t){e.loading=!1,Object(u["a"])(e.$store)(t,function(t,n){var o=t.path;void 0!==e.errors[o]?e.errors[o]=t.message:n.push(t.message)})}))},setFocusInput:function(t){this.focusInput=t},setMentions:function(t){this.mentions=t}},watch:{"$store.state.username":function(t){t||this.$router.push("/")}},mounted:function(){this.$store.dispatch("setTitle","new thread"),Object(d["a"])("threadNew")},beforeRouteEnter:function(t,e,n){n(function(t){t.$store.state.username||(t.$store.commit("setAccountModalState",!0),n("/"))})}},h=f,v=(n("f144"),n("2877")),p=Object(v["a"])(h,o,i,!1,null,null,null);p.options.__file="ThreadNew.vue";e["default"]=p.exports},ee60:function(t,e,n){"use strict";var o=n("508c"),i=n.n(o);i.a},f144:function(t,e,n){"use strict";var o=n("45a3"),i=n.n(o);i.a}}]);
//# sourceMappingURL=chunk-3800b976.e096a123.js.map