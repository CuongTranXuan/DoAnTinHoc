(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a5d0a906"],{"190c":function(t,e,s){},"1c59":function(t,e,s){"use strict";var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post",class:{"post--highlighted":t.highlight,"post--selected":t.selected},on:{mouseenter:function(e){t.hover=!0},mouseleave:function(e){t.hover=!1},click:t.goToPost}},[s("div",{staticClass:"post__quote",class:{"post__quote--show":t.showQuote&&t.allowQuote&&t.showReply&&t.$store.state.username},style:{left:t.quoteX+"px",top:t.quoteY+"px"},on:{mousedown:t.emitReply}},[s("span",{staticClass:"post__quote__icon fa fa-quote-right"}),t._v("\n\t\tQuote post\t\n\t")]),s("span",{staticClass:"post__remove_icon fa fa-check",class:{"post__remove_icon--show":t.showSelect&&!t.post.removed},on:{click:function(e){return e.stopPropagation(),t.toggleSelected(e)}}}),s("modal-window",{on:{click:function(t){t.stopPropagation()}},model:{value:t.showShareModal,callback:function(e){t.showShareModal=e},expression:"showShareModal"}},[s("div",{attrs:{slot:"main"},slot:"main"},[s("p",[t._v("Copy this URL to share the post")]),s("fancy-input",{attrs:{placeholder:"Post URL",value:t.postURL,width:"100%"}})],1),s("button",{staticClass:"button button--modal",attrs:{slot:"footer"},on:{click:function(e){e.stopPropagation(),t.setShareModalState(!1)}},slot:"footer"},[t._v("OK")])]),s("div",{staticClass:"post__meta_data"},[s("div",{staticStyle:{display:"inline-flex"}},[s("avatar-icon",{staticClass:"post__avatar",attrs:{user:t.post.User}}),t.showThread?s("div",{staticClass:"post__thread",on:{click:function(e){return e.stopPropagation(),t.goToThread(e)}}},[t._v("\n\t\t\t\tIn thread "),s("span",{staticClass:"post__thread__name"},[t._v(t._s(t.post.Thread.name))]),t._v("\n\t\t\t\t · \n\t\t\t")]):s("div",{staticClass:"post__user"},[t._v("\n\t\t\t\t"+t._s(t.username)+"\n\n\t\t\t\t"),t.post.User&&t.post.User.admin?s("span",{staticClass:"admin_badge"},[t._v("admin")]):t._e()]),t.post.replyingToUsername?s("replying-to",{staticStyle:{"margin-right":"0.5rem"},attrs:{replyId:t.post.replyId,username:t.post.replyingToUsername},on:{click:function(e){t.$emit("goToPost",t.post.replyId,!0)}}}):t._e()],1),s("div",{staticClass:"post__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))])]),s("div",{staticClass:"post__date post__date--mobile"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))]),s("div",{staticClass:"post__content",attrs:{tabindex:"-1"},domProps:{innerHTML:t._s(t.postContentHTML)},on:{mouseup:t.setShowQuote,blur:function(e){t.showQuote=!1}}}),s("div",{staticClass:"post__footer"},[s("div",{staticClass:"post__footer_group"},[s("div",{staticClass:"post__footer_sub_group"},[t.showReply?s("heart-button",{attrs:{post:t.post}}):t._e()],1),t.post.Replies.length?s("div",{staticClass:"post__footer_sub_group"},[s("span",{staticClass:"post__footer_sub_group__text post__footer_sub_group__text--replies"},[t._v("replies")]),t._l(t.post.Replies,function(e,o){return s("post-reply",{key:e.postNumber,attrs:{post:e,hover:t.hover,first:0===o},on:{click:function(s){t.$emit("goToPost",e.postNumber)}}})})],2):t._e()]),s("div",{staticClass:"post__footer_group post__actions",class:{"post__actions--show":t.showActions}},[s("div",{staticClass:"post__action post__share",on:{click:function(e){e.stopPropagation(),t.setShareModalState(!0)}}},[t._v("share")]),t.$store.state.username&&t.showReply?s("div",{staticClass:"post__action post__reply",on:{click:function(e){e.stopPropagation(),t.$emit("reply",t.post.id,t.username)}}},[t._v("\n\t\t\t\treply\n\t\t\t")]):t._e()])]),s("div",{staticClass:"post__replies"})],1)},n=[],a=(s("a481"),s("6b54"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("info-tooltip",{staticClass:"post_reply",class:{"post_reply--hover":t.hover,"post_reply--first":t.first}},[s("template",{slot:"content"},[s("div",{staticStyle:{"margin-top":"-0.25rem"}},[s("div",{staticClass:"post_reply__username"},[t._v(t._s(t.user.username))]),s("div",{staticClass:"post_reply__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))])]),s("div",{staticClass:"post_reply__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))])]),s("div",{staticClass:"post_reply__display",attrs:{slot:"display"},on:{click:function(e){e.stopPropagation(),t.$emit("click")}},slot:"display"},[s("div",{staticClass:"post_reply__letter",style:{"background-color":t.user.color}},[t._v("\n\t\t\t"+t._s(t.user.letter)+"\n\t\t")])])],2)}),i=[],r=(s("f751"),s("cadf"),s("551c"),s("097d"),s("44ea")),l={name:"PostReply",props:["post","hover","first"],components:{InfoTooltip:r["a"]},computed:{user:function(){return this.post.User?Object.assign({letter:this.post.User.username[0]},this.post.User):{letter:" ",color:null,username:"[deleted]"}}}},c=l,p=(s("dd92"),s("2877")),u=Object(p["a"])(c,a,i,!1,null,null,null);u.options.__file="PostReply.vue";var _=u.exports,d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"heart_button"},[s("modal-window",{attrs:{"close-button":!0,"hide-footer":!0,"no-padding":!0},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("div",{staticClass:"heart_button__modal",attrs:{slot:"main"},slot:"main"},[s("div",{staticClass:"heart_button__modal__header"},[t._v("Likes")]),t._l(t.likes,function(e){return s("div",{staticClass:"heart_button__modal__user",on:{click:function(s){t.$router.push("/user/"+e.username)}}},[s("avatar-icon",{attrs:{user:e,size:"small"}}),s("div",{staticClass:"heart_button__modal__username"},[t._v(t._s(e.username))])],1)}),t.likes.length?t._e():s("div",{staticClass:"heart_button__modal__empty"},[t._v("\n\t\t\t\tNo likes\n\t\t\t")])],2)]),s("span",{staticClass:"heart_button__heart fa",class:{"heart_button__heart--unlikeable":!t.likeable,"heart_button__heart--liked":t.liked},on:{click:t.changeLike}}),s("span",{staticClass:"heart_button__count",on:{click:function(e){t.showModal=!0}}},[t._v(t._s(t.likes.length))])],1)},h=[],f=s("6307"),m=s("9098"),v=s("c4b0"),g={name:"HeartButton",props:["post"],components:{ModalWindow:f["a"],AvatarIcon:m["a"]},data:function(){return{likes:this.post.Likes,showModal:!1}},computed:{likeable:function(){var t=this.post.User?this.post.User.username:null;return this.$store.state.username&&t!==this.$store.state.username},liked:function(){var t=this;return this.likes.some(function(e){return e.username===t.$store.state.username})}},methods:{getIndexOfUser:function(){for(var t,e=0;e<this.likes.length;e++){var s=this.likes[e];if(s.username===this.$store.state.username){t=e;break}}return t},changeLike:function(t){var e=this,s=this.post.id;this.likeable&&(this.liked?this.axios.delete("/api/v1/post/"+s+"/like").then(function(){e.likes.splice(e.getIndexOfUser(),1)}).catch(Object(v["a"])(this.$store)):this.axios.put("/api/v1/post/"+s+"/like").then(function(){return e.axios.get("/api/v1/user/"+e.$store.state.username)}).then(function(t){e.likes.push(t.data)}).catch(Object(v["a"])(this.$store)))}}},b=g,y=(s("e2b1"),Object(p["a"])(b,d,h,!1,null,"07099b20",null));y.options.__file="HeartButton.vue";var w=y.exports,k=s("80e3"),C=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("info-tooltip",{staticClass:"replying_to",on:{hover:t.loadPost}},[s("template",{slot:"content"},[s("div",{staticStyle:{"margin-top":"-0.25rem"}},[t.post?s("div",{staticClass:"replying_to__username"},[t._v(t._s(t.postUsername))]):t._e(),t.post?s("div",{staticClass:"replying_to__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))]):t._e()]),t.post?s("div",{staticClass:"replying_to__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))]):[t._v("Loading...")]],2),s("div",{staticClass:"replying_to__display",attrs:{slot:"display"},on:{click:function(e){e.stopPropagation(),t.$emit("click")}},slot:"display"},[s("span",{staticClass:"fa fa-reply replying_to__icon"}),t._v("\n\t\t"+t._s(t.username||"[deleted]")+"\n\t")])],2)},S=[],T={name:"ReplyingTo",props:["replyId","username"],components:{InfoTooltip:r["a"]},data:function(){return{post:null}},computed:{postUsername:function(){return this.post.User?this.post.User.username:"[deleted]"}},methods:{loadPost:function(){var t=this;this.post||this.axios.get("/api/v1/post/"+this.replyId).then(function(e){t.post=e.data}).catch(Object(v["a"])(this.$store))}}},$=T,R=(s("acf9"),Object(p["a"])($,C,S,!1,null,null,null));R.options.__file="ReplyingTo.vue";var x=R.exports,P={name:"ThreadPost",props:["post","highlight","showReply","showThread","showSelect","clickForPost","allowQuote"],components:{PostReply:_,ModalWindow:f["a"],FancyInput:k["a"],ReplyingTo:x,AvatarIcon:m["a"],HeartButton:w},data:function(){var t=this.post;return{hover:!1,showShareModal:!1,postURL:"".concat(location.origin,"/p/").concat(t.id),selected:!1,showQuote:!1,quoteX:0,quoteY:0,quoteSelection:"",postContentHTML:t.content}},computed:{username:function(){return this.post.User?this.post.User.username:"[deleted]"},showActions:function(){return this.hover||this.showShareModal}},methods:{emitReply:function(t){this.showQuote=!1,this.$emit("reply",this.post.id,this.username,this.quoteSelection)},setShowQuote:function(t){var e=this.$el.getBoundingClientRect(),s=window.getSelection(),o=s.getRangeAt(0).getBoundingClientRect(),n=s.toString();n.length?(this.quoteY=o.top-e.top-30,this.quoteX=o.left-e.left,this.quoteSelection="> "+n.replace(/\n/g,"\n> ")+"\n\n",this.showQuote=!0):this.showQuote=!1},setShareModalState:function(t){this.showShareModal=t},goToThread:function(){this.$router.push("/thread/".concat(this.post.Thread.slug,"/").concat(this.post.Thread.id))},goToPost:function(){this.clickForPost&&this.$router.push("/thread/"+this.post.Thread.slug+"/"+this.post.Thread.id+"/"+this.post.postNumber)},toggleSelected:function(){this.selected=!this.selected,this.$emit("selected",this.post.id)}},watch:{showSelect:function(){this.selected&&this.$emit("selected",this.post.id),this.selected=!1}},mounted:function(){var t=this;this.$linkExpander(this.post.content,function(e){return t.postContentHTML=e})}},U=P,M=(s("271c"),Object(p["a"])(U,o,n,!1,null,"d687ed54",null));M.options.__file="ThreadPost.vue";e["a"]=M.exports},"271c":function(t,e,s){"use strict";var o=s("bef2"),n=s.n(o);n.a},3846:function(t,e,s){s("9e1e")&&"g"!=/./g.flags&&s("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:s("0bfb")})},"6b54":function(t,e,s){"use strict";s("3846");var o=s("cb7c"),n=s("0bfb"),a=s("9e1e"),i="toString",r=/./[i],l=function(t){s("2aba")(RegExp.prototype,i,t,!0)};s("79e5")(function(){return"/a/b"!=r.call({source:"a",flags:"b"})})?l(function(){var t=o(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?n.call(t):void 0)}):r.name!=i&&l(function(){return r.call(this)})},8674:function(t,e,s){"use strict";var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"scroll_load"},[t._t("default")],2)},n=[],a=s("8e8d"),i=s("84a2"),r=s.n(i),l={name:"ScrollLoad",props:["loading","query-selector","padding-bottom","padding-top"],components:{LoadingButton:a["a"]},computed:{element:function(){return this.querySelector?document.querySelector(this.querySelector):null}},methods:{onScroll:r()(function(t){var e,s,o=this.paddingBottom||300,n=this.paddingTop||150;this.loading||(this.element?(e=Math.floor(this.element.scrollTop+this.element.getBoundingClientRect().height+o-this.element.scrollHeight),s=n-this.element.scrollTop):(e=window.innerHeight+window.pageYOffset+o-document.body.scrollHeight,s=n-document.body.scrollTop),e>0?this.$emit("loadNext"):s>0&&this.$emit("loadPrevious"))})},mounted:function(){(this.element||window).addEventListener("scroll",this.onScroll)},destroyed:function(){(this.element||window).removeEventListener("scroll",this.onScroll)}},c=l,p=s("2877"),u=Object(p["a"])(c,o,n,!1,null,null,null);u.options.__file="ScrollLoad.vue";e["a"]=u.exports},acf9:function(t,e,s){"use strict";var o=s("190c"),n=s.n(o);n.a},ba05:function(t,e,s){},bef2:function(t,e,s){},dd92:function(t,e,s){"use strict";var o=s("f44b"),n=s.n(o);n.a},e2b1:function(t,e,s){"use strict";var o=s("ba05"),n=s.n(o);n.a},f44b:function(t,e,s){}}]);
//# sourceMappingURL=chunk-a5d0a906.5fa428e4.js.map