(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cec67f0"],{"190c":function(t,e,o){},"1c59":function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"post",class:{"post--highlighted":t.highlight,"post--selected":t.selected},on:{mouseenter:function(e){t.hover=!0},mouseleave:function(e){t.hover=!1},click:t.goToPost}},[o("div",{staticClass:"post__quote",class:{"post__quote--show":t.showQuote&&t.allowQuote&&t.showReply&&t.$store.state.username},style:{left:t.quoteX+"px",top:t.quoteY+"px"},on:{mousedown:t.emitReply}},[o("span",{staticClass:"post__quote__icon fa fa-quote-right"}),t._v("\n\t\tQuote post\t\n\t")]),o("span",{staticClass:"post__remove_icon fa fa-check",class:{"post__remove_icon--show":t.showSelect&&!t.post.removed},on:{click:function(e){return e.stopPropagation(),t.toggleSelected(e)}}}),o("modal-window",{on:{click:function(t){t.stopPropagation()}},model:{value:t.showShareModal,callback:function(e){t.showShareModal=e},expression:"showShareModal"}},[o("div",{attrs:{slot:"main"},slot:"main"},[o("p",[t._v("Copy this URL to share the post")]),o("fancy-input",{attrs:{placeholder:"Post URL",value:t.postURL,width:"100%"}})],1),o("button",{staticClass:"button button--modal",attrs:{slot:"footer"},on:{click:function(e){e.stopPropagation(),t.setShareModalState(!1)}},slot:"footer"},[t._v("OK")])]),o("div",{staticClass:"post__meta_data"},[o("div",{staticStyle:{display:"inline-flex"}},[o("avatar-icon",{staticClass:"post__avatar",attrs:{user:t.post.User}}),t.showThread?o("div",{staticClass:"post__thread",on:{click:function(e){return e.stopPropagation(),t.goToThread(e)}}},[t._v("\n\t\t\t\tIn thread "),o("span",{staticClass:"post__thread__name"},[t._v(t._s(t.post.Thread.name))]),t._v("\n\t\t\t\t · \n\t\t\t")]):o("div",{staticClass:"post__user"},[t._v("\n\t\t\t\t"+t._s(t.username)+"\n\n\t\t\t\t"),t.post.User&&t.post.User.admin?o("span",{staticClass:"admin_badge"},[t._v("admin")]):t._e()]),t.post.replyingToUsername?o("replying-to",{staticStyle:{"margin-right":"0.5rem"},attrs:{replyId:t.post.replyId,username:t.post.replyingToUsername},on:{click:function(e){t.$emit("goToPost",t.post.replyId,!0)}}}):t._e()],1),o("div",{staticClass:"post__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))])]),o("div",{staticClass:"post__date post__date--mobile"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))]),o("div",{staticClass:"post__content",attrs:{tabindex:"-1"},domProps:{innerHTML:t._s(t.postContentHTML)},on:{mouseup:t.setShowQuote,blur:function(e){t.showQuote=!1}}}),o("div",{staticClass:"post__footer"},[o("div",{staticClass:"post__footer_group"},[o("div",{staticClass:"post__footer_sub_group"},[t.showReply?o("heart-button",{attrs:{post:t.post}}):t._e()],1),t.post.Replies.length?o("div",{staticClass:"post__footer_sub_group"},[o("span",{staticClass:"post__footer_sub_group__text post__footer_sub_group__text--replies"},[t._v("replies")]),t._l(t.post.Replies,function(e,s){return o("post-reply",{key:e.postNumber,attrs:{post:e,hover:t.hover,first:0===s},on:{click:function(o){t.$emit("goToPost",e.postNumber)}}})})],2):t._e()]),o("div",{staticClass:"post__footer_group post__actions",class:{"post__actions--show":t.showActions}},[o("div",{staticClass:"post__action post__share",on:{click:function(e){e.stopPropagation(),t.setShareModalState(!0)}}},[t._v("share")]),t.$store.state.username&&t.showReply?o("div",{staticClass:"post__action post__reply",on:{click:function(e){e.stopPropagation(),t.$emit("reply",t.post.id,t.username)}}},[t._v("\n\t\t\t\treply\n\t\t\t")]):t._e()])]),o("div",{staticClass:"post__replies"})],1)},n=[],i=(o("a481"),o("6b54"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("info-tooltip",{staticClass:"post_reply",class:{"post_reply--hover":t.hover,"post_reply--first":t.first}},[o("template",{slot:"content"},[o("div",{staticStyle:{"margin-top":"-0.25rem"}},[o("div",{staticClass:"post_reply__username"},[t._v(t._s(t.user.username))]),o("div",{staticClass:"post_reply__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))])]),o("div",{staticClass:"post_reply__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))])]),o("div",{staticClass:"post_reply__display",attrs:{slot:"display"},on:{click:function(e){e.stopPropagation(),t.$emit("click")}},slot:"display"},[o("div",{staticClass:"post_reply__letter",style:{"background-color":t.user.color}},[t._v("\n\t\t\t"+t._s(t.user.letter)+"\n\t\t")])])],2)}),a=[],r=(o("f751"),o("cadf"),o("551c"),o("097d"),o("44ea")),l={name:"PostReply",props:["post","hover","first"],components:{InfoTooltip:r["a"]},computed:{user:function(){return this.post.User?Object.assign({letter:this.post.User.username[0]},this.post.User):{letter:" ",color:null,username:"[deleted]"}}}},c=l,u=(o("dd92"),o("2877")),p=Object(u["a"])(c,i,a,!1,null,null,null);p.options.__file="PostReply.vue";var d=p.exports,h=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"heart_button"},[o("modal-window",{attrs:{"close-button":!0,"hide-footer":!0,"no-padding":!0},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[o("div",{staticClass:"heart_button__modal",attrs:{slot:"main"},slot:"main"},[o("div",{staticClass:"heart_button__modal__header"},[t._v("Likes")]),t._l(t.likes,function(e){return o("div",{staticClass:"heart_button__modal__user",on:{click:function(o){t.$router.push("/user/"+e.username)}}},[o("avatar-icon",{attrs:{user:e,size:"small"}}),o("div",{staticClass:"heart_button__modal__username"},[t._v(t._s(e.username))])],1)}),t.likes.length?t._e():o("div",{staticClass:"heart_button__modal__empty"},[t._v("\n\t\t\t\tNo likes\n\t\t\t")])],2)]),o("span",{staticClass:"heart_button__heart fa",class:{"heart_button__heart--unlikeable":!t.likeable,"heart_button__heart--liked":t.liked},on:{click:t.changeLike}}),o("span",{staticClass:"heart_button__count",on:{click:function(e){t.showModal=!0}}},[t._v(t._s(t.likes.length))])],1)},_=[],f=o("6307"),v=o("9098"),m=o("c4b0"),g={name:"HeartButton",props:["post"],components:{ModalWindow:f["a"],AvatarIcon:v["a"]},data:function(){return{likes:this.post.Likes,showModal:!1}},computed:{likeable:function(){var t=this.post.User?this.post.User.username:null;return this.$store.state.username&&t!==this.$store.state.username},liked:function(){var t=this;return this.likes.some(function(e){return e.username===t.$store.state.username})}},methods:{getIndexOfUser:function(){for(var t,e=0;e<this.likes.length;e++){var o=this.likes[e];if(o.username===this.$store.state.username){t=e;break}}return t},changeLike:function(t){var e=this,o=this.post.id;this.likeable&&(this.liked?this.axios.delete("/api/v1/post/"+o+"/like").then(function(){e.likes.splice(e.getIndexOfUser(),1)}).catch(Object(m["a"])(this.$store)):this.axios.put("/api/v1/post/"+o+"/like").then(function(){return e.axios.get("/api/v1/user/"+e.$store.state.username)}).then(function(t){e.likes.push(t.data)}).catch(Object(m["a"])(this.$store)))}}},b=g,y=(o("e2b1"),Object(u["a"])(b,h,_,!1,null,"07099b20",null));y.options.__file="HeartButton.vue";var w=y.exports,k=o("80e3"),C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("info-tooltip",{staticClass:"replying_to",on:{hover:t.loadPost}},[o("template",{slot:"content"},[o("div",{staticStyle:{"margin-top":"-0.25rem"}},[t.post?o("div",{staticClass:"replying_to__username"},[t._v(t._s(t.postUsername))]):t._e(),t.post?o("div",{staticClass:"replying_to__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))]):t._e()]),t.post?o("div",{staticClass:"replying_to__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))]):[t._v("Loading...")]],2),o("div",{staticClass:"replying_to__display",attrs:{slot:"display"},on:{click:function(e){e.stopPropagation(),t.$emit("click")}},slot:"display"},[o("span",{staticClass:"fa fa-reply replying_to__icon"}),t._v("\n\t\t"+t._s(t.username||"[deleted]")+"\n\t")])],2)},T=[],S={name:"ReplyingTo",props:["replyId","username"],components:{InfoTooltip:r["a"]},data:function(){return{post:null}},computed:{postUsername:function(){return this.post.User?this.post.User.username:"[deleted]"}},methods:{loadPost:function(){var t=this;this.post||this.axios.get("/api/v1/post/"+this.replyId).then(function(e){t.post=e.data}).catch(Object(m["a"])(this.$store))}}},$=S,x=(o("acf9"),Object(u["a"])($,C,T,!1,null,null,null));x.options.__file="ReplyingTo.vue";var P=x.exports,R={name:"ThreadPost",props:["post","highlight","showReply","showThread","showSelect","clickForPost","allowQuote"],components:{PostReply:d,ModalWindow:f["a"],FancyInput:k["a"],ReplyingTo:P,AvatarIcon:v["a"],HeartButton:w},data:function(){var t=this.post;return{hover:!1,showShareModal:!1,postURL:"".concat(location.origin,"/p/").concat(t.id),selected:!1,showQuote:!1,quoteX:0,quoteY:0,quoteSelection:"",postContentHTML:t.content}},computed:{username:function(){return this.post.User?this.post.User.username:"[deleted]"},showActions:function(){return this.hover||this.showShareModal}},methods:{emitReply:function(t){this.showQuote=!1,this.$emit("reply",this.post.id,this.username,this.quoteSelection)},setShowQuote:function(t){var e=this.$el.getBoundingClientRect(),o=window.getSelection(),s=o.getRangeAt(0).getBoundingClientRect(),n=o.toString();n.length?(this.quoteY=s.top-e.top-30,this.quoteX=s.left-e.left,this.quoteSelection="> "+n.replace(/\n/g,"\n> ")+"\n\n",this.showQuote=!0):this.showQuote=!1},setShareModalState:function(t){this.showShareModal=t},goToThread:function(){this.$router.push("/thread/".concat(this.post.Thread.slug,"/").concat(this.post.Thread.id))},goToPost:function(){this.clickForPost&&this.$router.push("/thread/"+this.post.Thread.slug+"/"+this.post.Thread.id+"/"+this.post.postNumber)},toggleSelected:function(){this.selected=!this.selected,this.$emit("selected",this.post.id)}},watch:{showSelect:function(){this.selected&&this.$emit("selected",this.post.id),this.selected=!1}},mounted:function(){var t=this;this.$linkExpander(this.post.content,function(e){return t.postContentHTML=e})}},M=R,U=(o("271c"),Object(u["a"])(M,s,n,!1,null,"d687ed54",null));U.options.__file="ThreadPost.vue";e["a"]=U.exports},"271c":function(t,e,o){"use strict";var s=o("bef2"),n=o.n(s);n.a},3846:function(t,e,o){o("9e1e")&&"g"!=/./g.flags&&o("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:o("0bfb")})},"6b54":function(t,e,o){"use strict";o("3846");var s=o("cb7c"),n=o("0bfb"),i=o("9e1e"),a="toString",r=/./[a],l=function(t){o("2aba")(RegExp.prototype,a,t,!0)};o("79e5")(function(){return"/a/b"!=r.call({source:"a",flags:"b"})})?l(function(){var t=s(this);return"/".concat(t.source,"/","flags"in t?t.flags:!i&&t instanceof RegExp?n.call(t):void 0)}):r.name!=a&&l(function(){return r.call(this)})},"84a2":function(t,e,o){(function(e){var o="Expected a function",s=NaN,n="[object Symbol]",i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,u="object"==typeof e&&e&&e.Object===Object&&e,p="object"==typeof self&&self&&self.Object===Object&&self,d=u||p||Function("return this")(),h=Object.prototype,_=h.toString,f=Math.max,v=Math.min,m=function(){return d.Date.now()};function g(t,e,s){var n,i,a,r,l,c,u=0,p=!1,d=!1,h=!0;if("function"!=typeof t)throw new TypeError(o);function _(e){var o=n,s=i;return n=i=void 0,u=e,r=t.apply(s,o),r}function g(t){return u=t,l=setTimeout(k,e),p?_(t):r}function b(t){var o=t-c,s=t-u,n=e-o;return d?v(n,a-s):n}function w(t){var o=t-c,s=t-u;return void 0===c||o>=e||o<0||d&&s>=a}function k(){var t=m();if(w(t))return T(t);l=setTimeout(k,b(t))}function T(t){return l=void 0,h&&n?_(t):(n=i=void 0,r)}function S(){void 0!==l&&clearTimeout(l),u=0,n=c=i=l=void 0}function $(){return void 0===l?r:T(m())}function x(){var t=m(),o=w(t);if(n=arguments,i=this,c=t,o){if(void 0===l)return g(c);if(d)return l=setTimeout(k,e),_(c)}return void 0===l&&(l=setTimeout(k,e)),r}return e=C(e)||0,y(s)&&(p=!!s.leading,d="maxWait"in s,a=d?f(C(s.maxWait)||0,e):a,h="trailing"in s?!!s.trailing:h),x.cancel=S,x.flush=$,x}function b(t,e,s){var n=!0,i=!0;if("function"!=typeof t)throw new TypeError(o);return y(s)&&(n="leading"in s?!!s.leading:n,i="trailing"in s?!!s.trailing:i),g(t,e,{leading:n,maxWait:e,trailing:i})}function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function w(t){return!!t&&"object"==typeof t}function k(t){return"symbol"==typeof t||w(t)&&_.call(t)==n}function C(t){if("number"==typeof t)return t;if(k(t))return s;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var o=r.test(t);return o||l.test(t)?c(t.slice(2),o?2:8):a.test(t)?s:+t}t.exports=b}).call(this,o("c8ba"))},8674:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"scroll_load"},[t._t("default")],2)},n=[],i=o("8e8d"),a=o("84a2"),r=o.n(a),l={name:"ScrollLoad",props:["loading","query-selector","padding-bottom","padding-top"],components:{LoadingButton:i["a"]},computed:{element:function(){return this.querySelector?document.querySelector(this.querySelector):null}},methods:{onScroll:r()(function(t){var e,o,s=this.paddingBottom||300,n=this.paddingTop||150;this.loading||(this.element?(e=Math.floor(this.element.scrollTop+this.element.getBoundingClientRect().height+s-this.element.scrollHeight),o=n-this.element.scrollTop):(e=window.innerHeight+window.pageYOffset+s-document.body.scrollHeight,o=n-document.body.scrollTop),e>0?this.$emit("loadNext"):o>0&&this.$emit("loadPrevious"))})},mounted:function(){(this.element||window).addEventListener("scroll",this.onScroll)},destroyed:function(){(this.element||window).removeEventListener("scroll",this.onScroll)}},c=l,u=o("2877"),p=Object(u["a"])(c,s,n,!1,null,null,null);p.options.__file="ScrollLoad.vue";e["a"]=p.exports},acf9:function(t,e,o){"use strict";var s=o("190c"),n=o.n(s);n.a},ba05:function(t,e,o){},bd28:function(t,e,o){"use strict";var s=o("bc3a"),n=o.n(s);e["a"]=function(t,e){"userPosts"===t||"userThreads"===t?n.a.get("/api/v1/user/"+e).then(function(e){return n.a.post("/api/v1/log",{route:t,resourceId:e.data.id})}).catch(console.log):n.a.post("/api/v1/log",{route:t,resourceId:e}).catch(console.log)}},bef2:function(t,e,o){},dd92:function(t,e,o){"use strict";var s=o("f44b"),n=o.n(s);n.a},e2b1:function(t,e,o){"use strict";var s=o("ba05"),n=o.n(s);n.a},f44b:function(t,e,o){}}]);
//# sourceMappingURL=chunk-5cec67f0.494f3959.js.map