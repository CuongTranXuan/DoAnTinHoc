(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71fc20bf"],{"45a3":function(t,e,n){},"4f7f":function(t,e,n){"use strict";var o=n("c26b"),r=n("b39a"),s="Set";t.exports=n("e0b8")(s,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(r(this,s),t=0===t?0:t,t)}},o)},"67ab":function(t,e,n){var o=n("ca5a")("meta"),r=n("d3f4"),s=n("69a8"),i=n("86cc").f,l=0,a=Object.isExtensible||function(){return!0},u=!n("79e5")(function(){return a(Object.preventExtensions({}))}),c=function(t){i(t,o,{value:{i:"O"+ ++l,w:{}}})},d=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,o)){if(!a(t))return"F";if(!e)return"E";c(t)}return t[o].i},f=function(t,e){if(!s(t,o)){if(!a(t))return!0;if(!e)return!1;c(t)}return t[o].w},h=function(t){return u&&p.NEED&&a(t)&&!s(t,o)&&c(t),t},p=t.exports={KEY:o,NEED:!1,fastKey:d,getWeak:f,onFreeze:h}},b39a:function(t,e,n){var o=n("d3f4");t.exports=function(t,e){if(!o(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},c26b:function(t,e,n){"use strict";var o=n("86cc").f,r=n("2aeb"),s=n("dcbc"),i=n("9b43"),l=n("f605"),a=n("4a59"),u=n("01f9"),c=n("d53b"),d=n("7a56"),f=n("9e1e"),h=n("67ab").fastKey,p=n("b39a"),v=f?"_s":"size",w=function(t,e){var n,o=h(e);if("F"!==o)return t._i[o];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var c=t(function(t,o){l(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=o&&a(o,n,t[u],t)});return s(c.prototype,{clear:function(){for(var t=p(this,e),n=t._i,o=t._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete n[o.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),o=w(n,t);if(o){var r=o.n,s=o.p;delete n._i[o.i],o.r=!0,s&&(s.n=r),r&&(r.p=s),n._f==o&&(n._f=r),n._l==o&&(n._l=s),n[v]--}return!!o},forEach:function(t){p(this,e);var n,o=i(t,arguments.length>1?arguments[1]:void 0,3);while(n=n?n.n:this._f){o(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function(t){return!!w(p(this,e),t)}}),f&&o(c.prototype,"size",{get:function(){return p(this,e)[v]}}),c},def:function(t,e,n){var o,r,s=w(t,e);return s?s.v=n:(t._l=s={i:r=h(e,!0),k:e,v:n,p:o=t._l,n:void 0,r:!1},t._f||(t._f=s),o&&(o.n=s),t[v]++,"F"!==r&&(t._i[r]=s)),t},getEntry:w,setStrong:function(t,e,n){u(t,e,function(t,n){this._t=p(t,e),this._k=n,this._l=void 0},function(){var t=this,e=t._k,n=t._l;while(n&&n.r)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?c(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,c(1))},n?"entries":"values",!n,!0),d(e)}}},e0b8:function(t,e,n){"use strict";var o=n("7726"),r=n("5ca1"),s=n("2aba"),i=n("dcbc"),l=n("67ab"),a=n("4a59"),u=n("f605"),c=n("d3f4"),d=n("79e5"),f=n("5cc5"),h=n("7f20"),p=n("5dbc");t.exports=function(t,e,n,v,w,_){var m=o[t],b=m,g=w?"set":"add",y=b&&b.prototype,k={},P=function(t){var e=y[t];s(y,t,"delete"==t?function(t){return!(_&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(_&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return _&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(_||y.forEach&&!d(function(){(new b).entries().next()}))){var Q=new b,F=Q[g](_?{}:-0,1)!=Q,x=d(function(){Q.has(1)}),j=f(function(t){new b(t)}),z=!_&&d(function(){var t=new b,e=5;while(e--)t[g](e,e);return!t.has(-0)});j||(b=e(function(e,n){u(e,b,t);var o=p(new m,e,b);return void 0!=n&&a(n,w,o[g],o),o}),b.prototype=y,y.constructor=b),(x||z)&&(P("delete"),P("has"),w&&P("get")),(z||F)&&P(g),_&&y.clear&&delete y.clear}else b=v.getConstructor(e,t,w,g),i(b.prototype,n),l.NEED=!0;return h(b,t),k[t]=b,r(r.G+r.W+r.F*(b!=m),k),_||v.setStrong(b,t,w),b}},e3ed:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"route_container thread_new"},[n("div",{staticClass:"h1"},[t._v("Post new thread")]),n("div",{staticClass:"thread_meta_info"},[n("div",{staticClass:"thread_meta_info__text"},[t._v("Enter the thread title and the category to post it in")]),n("div",{staticClass:"thread_meta_info__form"},[n("select-button",{attrs:{options:t.categories},model:{value:t.selectedCategory,callback:function(e){t.selectedCategory=e},expression:"selectedCategory"}}),n("fancy-input",{staticClass:"thread_meta_info__title",attrs:{placeholder:"Thread title",error:t.errors.name,large:"true",width:"15rem"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),t.showPoll?t._e():n("button",{staticClass:"thread_meta_info__add_poll button button--thin_text",on:{click:function(e){t.togglePoll(!0)}}},[t._v("Add poll")])],1),n("transition",{attrs:{name:"slide"}},[t.showPoll?n("div",{staticClass:"thread_meta_info__poll"},[n("div",{staticClass:"thread_meta_info__poll__top_bar"},[n("fancy-input",{staticClass:"thread_meta_info__poll__question",attrs:{placeholder:"Poll question",width:"20rem",large:!0,error:t.errors.pollQuestion},model:{value:t.pollQuestion,callback:function(e){t.pollQuestion=e},expression:"pollQuestion"}}),n("button",{staticClass:"button button--thin_text button--borderless",on:{click:t.removePoll}},[t._v("\n\t\t\t\t\t\tRemove poll\n\t\t\t\t\t")])],1),n("div",[t._l(t.pollAnswers,function(e,o){return n("div",{staticClass:"thread_meta_info__poll__answer"},[n("fancy-input",{attrs:{width:"15rem",large:!0,placeholder:"Answer "+(o+1)},model:{value:e.answer,callback:function(n){t.$set(e,"answer",n)},expression:"pollAnswer.answer"}}),n("span",{attrs:{title:"Remove answer"},on:{click:function(e){t.removePollAnswer(o)}}},[t._v("Ã—")])],1)}),n("div",{staticClass:"thread_meta_info__form"},[n("fancy-input",{staticStyle:{display:"inline-block","margin-right":"0.5rem"},attrs:{placeholder:"Option/answer for poll",width:"15rem",large:!0,error:t.errors.pollAnswer},model:{value:t.newPollAnswer,callback:function(e){t.newPollAnswer=e},expression:"newPollAnswer"}}),n("button",{staticClass:"button button--thin_text",on:{click:t.addPollAnswer}},[t._v("Add answer")])],1)],2)]):t._e()])],1),n("div",{staticClass:"editor",class:{"editor--focus":t.focusInput,"editor--error":t.errors.content}},[n("div",{staticClass:"editor__input"},[n("div",{staticClass:"editor__format_bar editor__format_bar--editor"},[t._v("\n\t\t\t\teditor\n\t\t\t")]),n("input-editor-core",{on:{mentions:t.setMentions,focus:function(e){t.setFocusInput(!0)},blur:function(e){t.setFocusInput(!1)}},model:{value:t.editor,callback:function(e){t.editor=e},expression:"editor"}})],1),n("div",{staticClass:"editor__preview"},[n("div",{staticClass:"editor__format_bar editor__format_bar--preview"},[t._v("\n\t\t\t\tpreview\n\t\t\t")]),n("input-editor-preview",{attrs:{value:t.editor,mentions:t.mentions}})],1)]),n("error-tooltip",{staticClass:"editor_error",attrs:{error:t.errors.content}}),n("loading-button",{staticClass:"button--green submit",attrs:{loading:t.loading},on:{click:t.postThread}},[t._v("Post thread")])],1)},r=[],s=(n("5df3"),n("4f7f"),n("7f7f"),n("ac6a"),n("cadf"),n("551c"),n("097d"),n("87e6")),i=n("b422"),l=n("80e3"),a=n("5016"),u=n("8e8d"),c=n("e145"),d=n("c4b0"),f=n("bd28"),h={name:"ThreadNew",components:{InputEditorCore:s["a"],InputEditorPreview:i["a"],SelectButton:a["a"],FancyInput:l["a"],LoadingButton:u["a"],ErrorTooltip:c["a"]},data:function(){return{selectedCategory:this.$store.state.category.selectedCategory,editor:"",mentions:[],name:"",loading:!1,focusInput:!1,errors:{content:"",name:"",pollQuestion:"",pollAnswer:""},showPoll:!1,pollQuestion:"",newPollAnswer:"",pollAnswers:[]}},computed:{categories:function(){return this.$store.getters.categoriesWithoutAll}},methods:{togglePoll:function(t){this.showPoll=void 0!==t?t:!this.showPoll},addPollAnswer:function(){this.newPollAnswer.trim().length&&(this.pollAnswers.push({answer:this.newPollAnswer}),this.newPollAnswer="")},removePollAnswer:function(t){this.pollAnswers.splice(t,1)},removePoll:function(){this.pollQuestion="",this.pollAnswers=[],this.newPollAnswer="",this.togglePoll()},setErrors:function(t){var e=this;t.forEach(function(t){e.errors[t.name]=t.error})},clearErrors:function(){this.errors.content="",this.errors.name="",this.errors.pollQuestion="",this.errors.pollAnswer=""},hasDuplicates:function(t,e){return e&&(t=t.map(e)),t.length!==new Set(t).size},postThread:function(){var t,e=this,n=[];this.clearErrors(),this.editor.trim().length||n.push({name:"content",error:"Post content cannot be blank"}),this.name.trim().length||n.push({name:"name",error:"Cannot be blank"}),this.showPoll&&!this.pollQuestion.trim().length&&n.push({name:"pollQuestion",error:"Cannot be blank"}),this.showPoll&&this.pollAnswers.length<2&&n.push({name:"pollAnswer",error:"You need at least 2 answers"}),this.showPoll&&this.hasDuplicates(this.pollAnswers,function(t){return t.answer})&&n.push({name:"pollAnswer",error:"Your answers can't contain any duplicates"}),n.length?this.setErrors(n):(this.loading=!0,this.axios.post("/api/v1/thread",{name:this.name,category:this.selectedCategory}).then(function(n){t=n.data;var o=[];return o.push(e.axios.post("/api/v1/post",{threadId:n.data.id,content:e.editor,mentions:e.mentions})),e.showPoll&&o.push(e.axios.post("/api/v1/poll",{question:e.pollQuestion,answers:e.pollAnswers.map(function(t){return t.answer}),threadId:n.data.id})),Promise.all(o)}).then(function(n){e.loading=!1,e.$router.push("/thread/".concat(t.slug,"/").concat(t.id,"/0"))}).catch(function(t){e.loading=!1,Object(d["a"])(e.$store)(t,function(t,n){var o=t.path;void 0!==e.errors[o]?e.errors[o]=t.message:n.push(t.message)})}))},setFocusInput:function(t){this.focusInput=t},setMentions:function(t){this.mentions=t}},watch:{"$store.state.username":function(t){t||this.$router.push("/")}},mounted:function(){this.$store.dispatch("setTitle","new thread"),Object(f["a"])("threadNew")},beforeRouteEnter:function(t,e,n){n(function(t){t.$store.state.username||(t.$store.commit("setAccountModalState",!0),n("/"))})}},p=h,v=(n("f144"),n("2877")),w=Object(v["a"])(p,o,r,!1,null,null,null);w.options.__file="ThreadNew.vue";e["default"]=w.exports},f144:function(t,e,n){"use strict";var o=n("45a3"),r=n.n(o);r.a}}]);
//# sourceMappingURL=chunk-71fc20bf.c1da079d.js.map