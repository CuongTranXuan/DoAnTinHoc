(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15a71224"],{"190c":function(t,e,o){},"1c59":function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"post",class:{"post--highlighted":t.highlight,"post--selected":t.selected},on:{mouseenter:function(e){t.hover=!0},mouseleave:function(e){t.hover=!1},click:t.goToPost}},[o("div",{staticClass:"post__quote",class:{"post__quote--show":t.showQuote&&t.allowQuote&&t.showReply&&t.$store.state.username},style:{left:t.quoteX+"px",top:t.quoteY+"px"},on:{mousedown:t.emitReply}},[o("span",{staticClass:"post__quote__icon fa fa-quote-right"}),t._v("\n\t\tQuote post\t\n\t")]),o("span",{staticClass:"post__remove_icon fa fa-check",class:{"post__remove_icon--show":t.showSelect&&!t.post.removed},on:{click:function(e){return e.stopPropagation(),t.toggleSelected(e)}}}),o("modal-window",{on:{click:function(t){t.stopPropagation()}},model:{value:t.showShareModal,callback:function(e){t.showShareModal=e},expression:"showShareModal"}},[o("div",{attrs:{slot:"main"},slot:"main"},[o("p",[t._v("Copy this URL to share the post")]),o("fancy-input",{attrs:{placeholder:"Post URL",value:t.postURL,width:"100%"}})],1),o("button",{staticClass:"button button--modal",attrs:{slot:"footer"},on:{click:function(e){e.stopPropagation(),t.setShareModalState(!1)}},slot:"footer"},[t._v("OK")])]),o("report-post-modal",{attrs:{"post-id":t.post.id},model:{value:t.showReportPostModal,callback:function(e){t.showReportPostModal=e},expression:"showReportPostModal"}}),o("div",{staticClass:"post__meta_data"},[o("div",{staticStyle:{display:"inline-flex"}},[o("avatar-icon",{staticClass:"post__avatar",attrs:{user:t.post.User}}),t.showThread?o("div",{staticClass:"post__thread",on:{click:function(e){return e.stopPropagation(),t.goToThread(e)}}},[t._v("\n\t\t\t\tIn thread "),o("span",{staticClass:"post__thread__name"},[t._v(t._s(t.post.Thread.name))]),t._v("\n\t\t\t\t · \n\t\t\t")]):o("div",{staticClass:"post__user"},[t._v("\n\t\t\t\t"+t._s(t.username)+"\n\n\t\t\t\t"),t.post.User&&t.post.User.admin?o("span",{staticClass:"admin_badge"},[t._v("admin")]):t._e()]),t.post.replyingToUsername?o("replying-to",{staticStyle:{"margin-right":"0.5rem"},attrs:{replyId:t.post.replyId,username:t.post.replyingToUsername},on:{click:function(e){t.$emit("goToPost",t.post.replyId,!0)}}}):t._e()],1),o("div",{staticClass:"post__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))])]),o("div",{staticClass:"post__date post__date--mobile"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"time|date",", ")))]),o("div",{staticClass:"post__content",attrs:{tabindex:"-1"},domProps:{innerHTML:t._s(t.postContentHTML)},on:{mouseup:t.setShowQuote,blur:function(e){t.showQuote=!1}}}),o("div",{staticClass:"post__footer"},[o("div",{staticClass:"post__footer_group"},[o("div",{staticClass:"post__footer_sub_group"},[t.showReply?o("heart-button",{attrs:{post:t.post}}):t._e()],1),t.post.Replies.length?o("div",{staticClass:"post__footer_sub_group"},[o("span",{staticClass:"post__footer_sub_group__text post__footer_sub_group__text--replies"},[t._v("replies")]),t._l(t.post.Replies,function(e,s){return o("post-reply",{key:e.postNumber,attrs:{post:e,hover:t.hover,first:0===s},on:{click:function(o){t.$emit("goToPost",e.postNumber)}}})})],2):t._e()]),o("div",{staticClass:"post__footer_group post__actions",class:{"post__actions--show":t.showActions}},[o("div",{staticClass:"post__action post__share",on:{click:function(e){e.stopPropagation(),t.setShareModalState(!0)}}},[t._v("share")]),t.$store.state.username&&!t.post.removed?o("div",{staticClass:"post__action",on:{click:function(e){e.stopPropagation(),t.setShowReportPostModal(!0)}}},[t._v("\n\t\t\t\treport\n\t\t\t")]):t._e(),t.$store.state.username&&t.showReply?o("div",{staticClass:"post__action post__reply",on:{click:function(e){e.stopPropagation(),t.$emit("reply",t.post.id,t.username)}}},[t._v("\n\t\t\t\treply\n\t\t\t")]):t._e()])]),o("div",{staticClass:"post__replies"})],1)},a=[],n=(o("a481"),o("6b54"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("info-tooltip",{staticClass:"post_reply",class:{"post_reply--hover":t.hover,"post_reply--first":t.first}},[o("template",{slot:"content"},[o("div",{staticStyle:{"margin-top":"-0.25rem"}},[o("div",{staticClass:"post_reply__username"},[t._v(t._s(t.user.username))]),o("div",{staticClass:"post_reply__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))])]),o("div",{staticClass:"post_reply__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))])]),o("div",{staticClass:"post_reply__display",attrs:{slot:"display"},on:{click:function(e){e.stopPropagation(),t.$emit("click")}},slot:"display"},[o("div",{staticClass:"post_reply__letter",style:{"background-color":t.user.color}},[t._v("\n\t\t\t"+t._s(t.user.letter)+"\n\t\t")])])],2)}),i=[],l=(o("f751"),o("44ea")),r={name:"PostReply",props:["post","hover","first"],components:{InfoTooltip:l["a"]},computed:{user:function(){return this.post.User?Object.assign({letter:this.post.User.username[0]},this.post.User):{letter:" ",color:null,username:"[deleted]"}}}},c=r,p=(o("dd92"),o("2877")),u=Object(p["a"])(c,n,i,!1,null,null,null);u.options.__file="PostReply.vue";var d=u.exports,_=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"heart_button"},[o("modal-window",{attrs:{"close-button":!0,"hide-footer":!0,"no-padding":!0},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[o("div",{staticClass:"heart_button__modal",attrs:{slot:"main"},slot:"main"},[o("div",{staticClass:"heart_button__modal__header"},[t._v("Likes")]),t._l(t.likes,function(e){return o("div",{staticClass:"heart_button__modal__user",on:{click:function(o){t.$router.push("/user/"+e.username)}}},[o("avatar-icon",{attrs:{user:e,size:"small"}}),o("div",{staticClass:"heart_button__modal__username"},[t._v(t._s(e.username))])],1)}),t.likes.length?t._e():o("div",{staticClass:"heart_button__modal__empty"},[t._v("\n\t\t\t\tNo likes\n\t\t\t")])],2)]),o("span",{staticClass:"heart_button__heart fa",class:{"heart_button__heart--unlikeable":!t.likeable,"heart_button__heart--liked":t.liked},on:{click:t.changeLike}}),o("span",{staticClass:"heart_button__count",on:{click:function(e){t.showModal=!0}}},[t._v(t._s(t.likes.length))])],1)},h=[],f=o("6307"),m=o("9098"),v=o("c4b0"),g={name:"HeartButton",props:["post"],components:{ModalWindow:f["a"],AvatarIcon:m["a"]},data:function(){return{likes:this.post.Likes,showModal:!1}},computed:{likeable:function(){var t=this.post.User?this.post.User.username:null;return this.$store.state.username&&t!==this.$store.state.username},liked:function(){var t=this;return this.likes.some(function(e){return e.username===t.$store.state.username})}},methods:{getIndexOfUser:function(){for(var t,e=0;e<this.likes.length;e++){var o=this.likes[e];if(o.username===this.$store.state.username){t=e;break}}return t},changeLike:function(t){var e=this,o=this.post.id;this.likeable&&(this.liked?this.axios.delete("/api/v1/post/"+o+"/like").then(function(){e.likes.splice(e.getIndexOfUser(),1)}).catch(Object(v["a"])(this.$store)):this.axios.put("/api/v1/post/"+o+"/like").then(function(){return e.axios.get("/api/v1/user/"+e.$store.state.username)}).then(function(t){e.likes.push(t.data)}).catch(Object(v["a"])(this.$store)))}}},b=g,w=(o("e2b1"),Object(p["a"])(b,_,h,!1,null,"07099b20",null));w.options.__file="HeartButton.vue";var y=w.exports,C=o("80e3"),k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("info-tooltip",{staticClass:"replying_to",on:{hover:t.loadPost}},[o("template",{slot:"content"},[o("div",{staticStyle:{"margin-top":"-0.25rem"}},[t.post?o("div",{staticClass:"replying_to__username"},[t._v(t._s(t.postUsername))]):t._e(),t.post?o("div",{staticClass:"replying_to__date"},[t._v(t._s(t._f("formatDate")(t.post.createdAt,"date|time"," - ")))]):t._e()]),t.post?o("div",{staticClass:"replying_to__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),100)))]):[t._v("Loading...")]],2),o("div",{staticClass:"replying_to__display",attrs:{slot:"display"},on:{click:function(e){e.stopPropagation(),t.$emit("click")}},slot:"display"},[o("span",{staticClass:"fa fa-reply replying_to__icon"}),t._v("\n\t\t"+t._s(t.username||"[deleted]")+"\n\t")])],2)},S=[],M={name:"ReplyingTo",props:["replyId","username"],components:{InfoTooltip:l["a"]},data:function(){return{post:null}},computed:{postUsername:function(){return this.post.User?this.post.User.username:"[deleted]"}},methods:{loadPost:function(){var t=this;this.post||this.axios.get("/api/v1/post/"+this.replyId).then(function(e){t.post=e.data}).catch(Object(v["a"])(this.$store))}}},P=M,R=(o("acf9"),Object(p["a"])(P,k,S,!1,null,null,null));R.options.__file="ReplyingTo.vue";var $=R.exports,T=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"report_post_modal"},[o("modal-window",{attrs:{loading:t.loading},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[o("div",{staticClass:"report_post_modal__modal",attrs:{slot:"main"},slot:"main"},[o("h3",[t._v("Report this post")]),o("div",{staticClass:"report_post_modal--margin"},[t._v("Select a reason for reporting this post below:")]),o("select-button",{staticClass:"report_post_modal--margin",attrs:{options:t.reportOptions,"touch-disabled":!0},model:{value:t.selectedOption,callback:function(e){t.selectedOption=e},expression:"selectedOption"}})],1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("button",{staticClass:"button button--modal",on:{click:function(e){return e.stopPropagation(),t.submitReport(e)}}},[t._v("Submit")]),o("button",{staticClass:"button button--modal",on:{click:function(e){e.stopPropagation(),t.setShowModal(!1)}}},[t._v("Cancel")])])])],1)},x=[],O=o("5016"),U={name:"ReportPostModal",props:["value","post-id"],components:{ModalWindow:f["a"],SelectButton:O["a"]},data:function(){return{showModal:!1,loading:!1,selectedOption:0,reportOptions:[{name:"Reason for reporting",disabled:!0},{name:"Spam",value:"spam"},{name:"Inappropriate content",value:"inappropriate"},{name:"Harassment",value:"harassment"}]}},methods:{setShowModal:function(t){this.showModal=t},submitReport:function(){var t=this;this.selectedOption&&(this.loading=!0,this.axios.post("/api/v1/report",{postId:this.postId,reason:this.selectedOption}).then(function(e){t.setShowModal(!1),t.selectedOption=0,t.loading=!1}).catch(function(e){t.loading=!1,Object(v["a"])(t.$store)(e)}))}},watch:{value:function(t){this.showModal=t,this.$emit("input",t)},showModal:function(t){this.$emit("input",t)}}},L=U,q=(o("9dd6"),Object(p["a"])(L,T,x,!1,null,"ac281c18",null));q.options.__file="ReportPostModal.vue";var I=q.exports,E={name:"ThreadPost",props:["post","highlight","showReply","showThread","showSelect","clickForPost","allowQuote"],components:{PostReply:d,ModalWindow:f["a"],FancyInput:C["a"],ReplyingTo:$,AvatarIcon:m["a"],HeartButton:y,ReportPostModal:I},data:function(){var t=this.post;return{hover:!1,showShareModal:!1,showReportPostModal:!1,postURL:"".concat(location.origin,"/p/").concat(t.id),selected:!1,showQuote:!1,quoteX:0,quoteY:0,quoteSelection:"",postContentHTML:t.content}},computed:{username:function(){return this.post.User?this.post.User.username:"[deleted]"},showActions:function(){return this.hover||this.showShareModal||this.showReportPostModal}},methods:{emitReply:function(t){this.showQuote=!1,this.$emit("reply",this.post.id,this.username,this.quoteSelection)},setShowQuote:function(t){var e=this.$el.getBoundingClientRect(),o=window.getSelection(),s=o.getRangeAt(0).getBoundingClientRect(),a=o.toString();a.length?(this.quoteY=s.top-e.top-30,this.quoteX=s.left-e.left,this.quoteSelection="> "+a.replace(/\n/g,"\n> ")+"\n\n",this.showQuote=!0):this.showQuote=!1},setShareModalState:function(t){this.showShareModal=t},setShowReportPostModal:function(t){this.showReportPostModal=t},goToThread:function(){this.$router.push("/thread/".concat(this.post.Thread.slug,"/").concat(this.post.Thread.id))},goToPost:function(){this.clickForPost&&this.$router.push("/thread/"+this.post.Thread.slug+"/"+this.post.Thread.id+"/"+this.post.postNumber)},toggleSelected:function(){this.selected=!this.selected,this.$emit("selected",this.post.id)}},watch:{showSelect:function(){this.selected&&this.$emit("selected",this.post.id),this.selected=!1}},mounted:function(){var t=this;this.$linkExpander(this.post.content,function(e){return t.postContentHTML=e})}},j=E,H=(o("9b68"),Object(p["a"])(j,s,a,!1,null,"661597d4",null));H.options.__file="ThreadPost.vue";e["a"]=H.exports},3846:function(t,e,o){o("9e1e")&&"g"!=/./g.flags&&o("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:o("0bfb")})},4273:function(t,e,o){"use strict";var s=o("ff99"),a=o.n(s);a.a},"6b54":function(t,e,o){"use strict";o("3846");var s=o("cb7c"),a=o("0bfb"),n=o("9e1e"),i="toString",l=/./[i],r=function(t){o("2aba")(RegExp.prototype,i,t,!0)};o("79e5")(function(){return"/a/b"!=l.call({source:"a",flags:"b"})})?r(function(){var t=s(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?a.call(t):void 0)}):l.name!=i&&r(function(){return l.call(this)})},"6c65":function(t,e,o){},8674:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"scroll_load"},[t._t("default")],2)},a=[],n=o("8e8d"),i=o("84a2"),l=o.n(i),r={name:"ScrollLoad",props:["loading","query-selector","padding-bottom","padding-top"],components:{LoadingButton:n["a"]},computed:{element:function(){return this.querySelector?document.querySelector(this.querySelector):null}},methods:{onScroll:l()(function(t){var e,o,s=this.paddingBottom||300,a=this.paddingTop||150;this.loading||(this.element?(e=Math.floor(this.element.scrollTop+this.element.getBoundingClientRect().height+s-this.element.scrollHeight),o=a-this.element.scrollTop):(e=window.innerHeight+window.pageYOffset+s-document.body.scrollHeight,o=a-document.body.scrollTop),e>0?this.$emit("loadNext"):o>0&&this.$emit("loadPrevious"))})},mounted:function(){(this.element||window).addEventListener("scroll",this.onScroll)},destroyed:function(){(this.element||window).removeEventListener("scroll",this.onScroll)}},c=r,p=o("2877"),u=Object(p["a"])(c,s,a,!1,null,null,null);u.options.__file="ScrollLoad.vue";e["a"]=u.exports},"9b34":function(t,e,o){},"9b68":function(t,e,o){"use strict";var s=o("9b34"),a=o.n(s);a.a},"9dd6":function(t,e,o){"use strict";var s=o("6c65"),a=o.n(s);a.a},acf9:function(t,e,o){"use strict";var s=o("190c"),a=o.n(s);a.a},ba05:function(t,e,o){},dd92:function(t,e,o){"use strict";var s=o("f44b"),a=o.n(s);a.a},e2b1:function(t,e,o){"use strict";var s=o("ba05"),a=o.n(s);a.a},eba0:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"post_placeholder"},[o("div",{staticClass:"post_placeholder__meta_data"},[o("div",{staticClass:"post_placeholder__avatar_icon"}),o("div",{staticClass:"post_placeholder__bar post_placeholder__bar--thin post_placeholder__bar--33"})]),o("div",{staticClass:"post_placeholder__content"},[o("div",{staticClass:"post_placeholder__bar post_placeholder__bar--58"}),o("div",{staticClass:"post_placeholder__bar post_placeholder__bar--66"}),o("div",{staticClass:"post_placeholder__bar post_placeholder__bar--50"})])])}],n={name:"ThreadPostPlaceholder"},i=n,l=(o("4273"),o("2877")),r=Object(l["a"])(i,s,a,!1,null,"6505f411",null);r.options.__file="ThreadPostPlaceholder.vue";e["a"]=r.exports},f44b:function(t,e,o){},ff99:function(t,e,o){}}]);
//# sourceMappingURL=chunk-15a71224.57aaacd0.js.map