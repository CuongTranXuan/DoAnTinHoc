(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c3044d0"],{"06d2":function(t,e,o){"use strict";var s=o("a760"),n=o.n(s);n.a},"1be9":function(t,e,o){},"59bf":function(t,e,o){"use strict";var s=o("1be9"),n=o.n(s);n.a},"8d1a":function(t,e,o){"use strict";var s=o("e7da"),n=o.n(s);n.a},"8f02":function(t,e,o){"use strict";var s=o("c67e"),n=o.n(s);n.a},9009:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"route_container",style:t.posts.length?"padding-bottom: 8.5rem;":null},[o("confirm-modal",{attrs:{text:"Delete",color:"red"},on:{confirm:t.deleteThread},model:{value:t.showConfirmModal,callback:function(e){t.showConfirmModal=e},expression:"showConfirmModal"}},[t._v("\n\t\tAre you sure you want to delete this thread?\n\t\t"),o("br"),t._v("This "),o("b",[t._v("cannot")]),t._v(" be undone\n\t")]),t.$store.state.thread.postNotification?o("thread-post-notification",{attrs:{post:t.$store.state.thread.postNotification},on:{close:function(e){t.$store.commit("thread/setPostNotification",null)},goToPost:t.goToPostNotification}}):t._e(),o("header",{staticClass:"thread_header"},[o("div",{ref:"title",staticClass:"thread_header__thread_title"},[t._v("\n\t\t\t"+t._s(t.thread)+"\n\t\t")])]),o("div",{staticClass:"thread_side_bar"},[t.$store.state.thread.showRemovePostsButton?o("loading-button",{staticClass:"button--thin_text",class:{"button--disabled":!t.$store.state.thread.selectedPosts.length},attrs:{loading:t.$store.state.thread.removePostsButtonLoading,dark:!0},on:{click:t.removePosts}},[t._v("\n\t\t\tRemove posts ("+t._s(t.$store.state.thread.selectedPosts.length)+")\n\t\t")]):t._e(),t.$store.state.admin?o("menu-button",{attrs:{options:[{event:"lock_thread",value:t.$store.state.thread.locked?"Unlock thread":"Lock thread"},{event:"delete_thread",value:"Delete thread"},{event:"remove_posts",value:"Remove posts"}]},on:{lock_thread:t.setThreadLockedState,remove_posts:t.setThreadSelectState,delete_thread:function(e){t.showConfirmModal=!0}}},[o("button",{staticClass:"button button--thin_text"},[o("span",{staticClass:"fa fa-cogs",staticStyle:{"margin-right":"0.25rem"}}),t._v("\n\t\t\t\tManage thread\n\t\t\t")])]):t._e(),t.$store.state.thread.locked?t._e():o("button",{staticClass:"button button--thin_text",on:{click:t.replyThread}},[t._v("\n\t\t\t"+t._s(t.replyThreadButton)+"\n\t\t")]),o("post-scrubber",{attrs:{posts:t.$store.state.thread.totalPostsCount,value:t.$route.params.post_number||0},on:{input:t.goToPost}})],1),o("input-editor",{attrs:{show:t.editorState,replyUsername:t.replyUsername,loading:t.$store.state.thread.editor.loading},on:{mentions:t.setMentions,close:t.hideEditor,submit:t.addPost},model:{value:t.editor,callback:function(e){t.editor=e},expression:"editor"}}),t.$store.state.thread.locked?o("div",{staticClass:"locked_thread"},[o("h2",[t._v("Thread locked")]),t._v("\n\t\tYou can't post in this thread because it has been locked by an administrator\n\t")]):t._e(),o("div",{staticClass:"posts"},[o("scroll-load",{on:{loadNext:t.loadNextPosts,loadPrevious:t.loadPreviousPosts}},[t._l(3,function(e){return t.posts.length?t._e():o("thread-post-placeholder",{key:e,class:{"post--last":2===e}})}),t._l(t.$store.state.thread.previousPostsCount,function(e){return"previous"===t.$store.state.thread.loadingPosts?o("thread-post-placeholder",{key:e}):t._e()}),t._l(t.posts,function(e,s){return o("thread-post",{key:e.id,ref:"posts",refInFor:!0,class:{"post--last":s===t.posts.length-1},attrs:{post:e,"show-reply":!t.$store.state.thread.locked,showSelect:t.$store.state.thread.showRemovePostsButton,highlight:t.highlightedPostIndex===s,allowQuote:!0},on:{reply:t.replyUser,goToPost:t.goToPost,selected:t.setSelectedPosts}})}),t._l(t.$store.state.thread.nextPostsCount,function(e){return"next"===t.$store.state.thread.loadingPosts?o("thread-post-placeholder",{key:e}):t._e()})],2)],1),t.$store.state.thread.category?o("more-threads",{attrs:{category:t.$store.state.thread.category,threadId:t.$store.state.thread.threadId}}):t._e()],1)},n=[],i=(o("55dd"),o("a481"),o("7514"),o("cadf"),o("551c"),o("097d"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"input_editor input_editor--float",class:{"input_editor--hidden":!t.show,"input_editor--focus-input":t.focusInput}},[o("div",{staticClass:"input_editor__overlay",class:{"input_editor__overlay--show":t.loading}},[o("loading-icon")],1),t.replyUsername?o("div",{staticClass:"input_editor__reply_username"},[t._v("Replying to "),o("strong",[t._v(t._s(t.replyUsername))])]):t._e(),o("div",{staticClass:"input_editor__close input_editor__format_button",on:{click:t.closeEditor}},[t._v("×")]),o("tab-view",{attrs:{tabs:["Editor","Preview"],"small-tabs":!0},model:{value:t.showTab,callback:function(e){t.showTab=e},expression:"showTab"}},[o("template",{slot:"Editor"},[o("input-editor-core",{attrs:{value:t.value,"right-align-emoji":!0,error:t.error},on:{input:t.emitInput,mentions:t.emitMentions,focus:function(e){t.setFocusInput(!0)},blur:function(e){t.setFocusInput(!1)}}})],1),o("template",{slot:"Preview"},[o("input-editor-preview",{attrs:{value:t.value,mentions:t.mentions}})],1)],2),o("div",{staticClass:"input_editor__submit_bar"},[o("button",{staticClass:"button button--thin_text",on:{click:t.submit}},[t._v("Submit")])])],1)}),r=[],a=o("87e6"),c=o("b422"),u=o("c5af"),d=o("6334"),l={name:"InputEditor",props:["value","error","replyUsername","show","loading"],components:{InputEditorCore:a["a"],InputEditorPreview:c["a"],LoadingIcon:u["a"],TabView:d["a"]},data:function(){return{showTab:0,mentions:[],focusInput:!1}},methods:{submit:function(){this.value.trim().length&&this.$emit("submit")},closeEditor:function(){this.emitInput(""),this.$emit("close")},emitMentions:function(t){this.mentions=t,this.$emit("mentions",t)},emitInput:function(t){this.$emit("input",t)},setFocusInput:function(t){this.focusInput=t}},watch:{show:function(t){var e;t&&(this.showTab=0),e=this.$el.querySelector("textarea"),e&&e.focus()}}},h=l,p=(o("8d1a"),o("2877")),f=Object(p["a"])(h,i,r,!1,null,"99e4421e",null);f.options.__file="InputEditor.vue";var m=f.exports,_=o("8674"),v=o("1c59"),g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"slide-fade"}},[o("div",{staticClass:"thread_post_notification",on:{click:function(e){t.$emit("goToPost")}}},[o("span",{staticClass:"thread_post_notification__close",on:{click:function(e){e.stopPropagation(),t.$emit("close")}}}),o("div",{staticClass:"thread_post_notification__header_bar"},[o("span",{staticClass:"thread_post_notification__username"},[t._v(t._s(t.post.username))]),t._v("\n\t\t\treplied  ·  click to view\n\t\t")]),o("div",{staticClass:"thread_post_notification__content"},[t._v(t._s(t._f("truncate")(t._f("stripTags")(t.post.content),150)))])])])},b=[],$={name:"ThreadPostNotification",props:["post"]},P=$,w=(o("06d2"),Object(p["a"])(P,g,b,!1,null,"4c3d14be",null));w.options.__file="ThreadPostNotification.vue";var C=w.exports,y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.posts-1?o("div",{staticClass:"post_scrubber"},[o("div",{staticClass:"post_scrubber__label post_scrubber__label--first",on:{click:function(e){t.$emit("input",0)}}},[t._v("First post")]),o("div",{ref:"line",staticClass:"post_scrubber__line",on:{click:t.lineClick}}),o("div",{staticClass:"post_scrubber__dragger",class:{"post_scrubber--no_top_transition":t.dragging},style:{top:t.draggerYCoord+"px"},on:{mousedown:function(e){e.preventDefault(),e.stopPropagation(),t.setDragging(!0)},mouseup:function(e){e.preventDefault(),e.stopPropagation(),t.setDragging(!1)}}}),o("div",{staticClass:"post_scrubber__dragger_info",class:{"post_scrubber--no_top_transition":t.dragging},style:{top:t.draggerYCoord+"px"}},[t._v("\n\t\tPost "),o("strong",[t._v(t._s(t.currentPost||0))]),t._v(" out of "+t._s(t.posts)+"\n\t")]),o("div",{staticClass:"post_scrubber__label post_scrubber__label--last",on:{click:function(e){t.$emit("input",t.posts-1)}}},[t._v("\n\t\tLatest post\n\t")])]):t._e()},T=[],k={name:"PostScrubber",props:["posts","value"],data:function(){return{clientY:0,dragging:!1}},computed:{draggerYCoord:function(){var t=this.getLineTop(),e=this.getLineHeight();if(!this.clientY||!t)return 0;var o=this.clientY-t;return o<0?0:o>e?e:o},currentPost:function(){var t,e=this.getLineHeight()/this.posts,o=Math.floor(this.draggerYCoord/e);return t=o===this.posts?o:o+1,t}},methods:{getLineHeight:function(){var t=this.$refs.line;if(!t)return 0;var e=t.getBoundingClientRect();return e.height},getLineTop:function(){var t=this.$refs.line;if(!t)return 0;var e=t.getBoundingClientRect();return e.top},setDragging:function(t){this.dragging=t,t||this.$emit("input",this.currentPost-1)},lineClick:function(t){this.clientY=t.clientY},setCurrentPost:function(){var t=this.getLineTop(),e=this.getLineHeight(),o=+this.value,s=e/this.posts;o+1===this.posts?this.clientY=t+e:this.clientY=t+s*o}},watch:{value:"setCurrentPost"},mounted:function(){var t=this;this.setCurrentPost(),window.addEventListener("mousemove",function(e){t.dragging&&(t.clientY=e.clientY)}),window.addEventListener("mouseup",function(e){t.dragging&&(t.dragging=!1,t.$emit("input",t.currentPost-1))})}},x=k,M=(o("ee7b"),Object(p["a"])(x,y,T,!1,null,"bf8af982",null));M.options.__file="PostScrubber.vue";var S=M.exports,I=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("menu-tooltip",{staticClass:"menu_button",attrs:{top:"0",width:"10rem","touch-disabled":"true"},model:{value:t.menuOpen,callback:function(e){t.menuOpen=e},expression:"menuOpen"}},[o("div",{staticClass:"menu_button__icon",attrs:{slot:"button"},on:{click:function(e){t.menuOpen=!0}},slot:"button"},[t._t("default")],2),o("template",{slot:"menu"},t._l(t.options,function(e,s){return o("div",{staticClass:"menu_button__option",style:{"border-bottom":s===t.options.length-1?"none":"solid thin rgb(245, 245, 245)"},on:{click:function(o){t.emit(e.event)}}},[t._v("\n\t\t\t"+t._s(e.value)+"\n\t\t")])}),0)],2)},E=[],N=o("6fab"),L={name:"MenuButton",props:["options"],components:{MenuTooltip:N["a"]},data:function(){return{menuOpen:!1}},methods:{emit:function(t){this.$emit(t),this.menuOpen=!1}}},O=L,R=(o("8f02"),Object(p["a"])(O,I,E,!1,null,"ee42c39a",null));R.options.__file="MenuButton.vue";var B=R.exports,Y=o("8e8d"),j=o("da16"),A=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"more_threads"},[o("div",{staticClass:"more_threads__header"},[t._v("More threads in category '"+t._s(t.category.name)+"'")]),t.empty?o("div",{staticClass:"more_threads__empty overlay_message"},[t._v("\n\t\tNo more threads to show\n\t")]):[t._m(0),t._l(t.threads,function(e){return o("div",{staticClass:"more_threads__thread",on:{click:function(o){t.goToThread(e)}}},[o("div",{staticClass:"more_threads__name"},[t._v(t._s(e.name))]),o("div",{staticClass:"more_threads__date_created"},[t._v(t._s(t._f("formatDate")(e.createdAt)))])])})]],2)},D=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"more_threads__thread more_threads__thread--header"},[o("div",{staticClass:"more_threads__name"},[t._v("Thread")]),o("div",{staticClass:"more_threads__date_created"},[t._v("Date created")])])}],U=o("c4b0"),F={name:"MoreThreads",props:["category","threadId"],data:function(){return{threads:[],empty:!1}},methods:{goToThread:function(t){this.$router.push("/thread/".concat(t.slug,"/").concat(t.id))}},mounted:function(){var t=this;this.axios.get("/api/v1/category/"+this.category.value).then(function(e){var o=e.data.Threads.filter(function(e){return e.id!==t.threadId});t.threads=o.slice(0,4),t.empty=!o.length}).catch(Object(U["a"])(this.$store))}},H=F,q=(o("b4cf"),Object(p["a"])(H,A,D,!1,null,"38a6e5a2",null));q.options.__file="MoreThreads.vue";var J=q.exports,V=o("bd28"),K=o("84a2"),Q=o.n(K),W={name:"Thread",components:{InputEditor:m,ScrollLoad:_["a"],ThreadPost:v["a"],ThreadPostNotification:C,PostScrubber:S,MenuButton:B,LoadingButton:Y["a"],ConfirmModal:j["a"],MoreThreads:J},data:function(){return{highlightedPostIndex:null,postNotification:null,showConfirmModal:!1}},computed:{thread:function(){return this.$store.state.thread.thread},posts:function(){return this.$store.getters.sortedPosts},replyUsername:function(){return this.$store.state.thread.reply.username},editor:{get:function(){return this.$store.state.thread.editor.value},set:function(t){this.$store.commit("setThreadEditorValue",t)}},editorState:function(){return this.$store.state.thread.editor.show},replyThreadButton:function(){return this.$store.state.username?"Reply to thread":"Login to reply"}},methods:{deleteThread:function(){this.$store.dispatch("deleteThread",this)},removePosts:function(){this.$store.dispatch("removePostsAsync",this)},setThreadLockedState:function(){this.$store.dispatch("setThreadLockedState",this)},setThreadSelectState:function(){this.$store.commit("setShowRemovePostsButton",!this.$store.state.thread.showRemovePostsButton)},setSelectedPosts:function(t){this.$store.commit("setSelectedPosts",t)},showEditor:function(){this.$store.commit("setThreadEditorState",!0)},hideEditor:function(){this.$store.commit("setThreadEditorState",!1),this.clearReply()},setMentions:function(t){this.$store.commit("setMentions",t)},clearReply:function(){this.$store.commit({type:"setReply",username:"",id:""})},replyThread:function(){this.$store.state.username?(this.clearReply(),this.showEditor()):(this.$store.commit("setAccountTabs",1),this.$store.commit("setAccountModalState",!0))},replyUser:function(t,e,o){this.$store.commit({type:"setReply",username:e,id:t,quote:o}),this.showEditor()},addPost:function(){this.$store.dispatch("addPostAsync",this)},loadNextPosts:function(){var t=this;this.$store.dispatch("loadPostsAsync",{vue:t,previous:!1})},loadPreviousPosts:function(){var t=this;this.$store.dispatch("loadPostsAsync",{vue:t,previous:!0})},loadInitialPosts:function(){this.$store.dispatch("loadInitialPostsAsync",this)},goToPost:function(t,e){var o=this,s=function(t){o.posts.find(function(e){return e.postNumber===t})?o.highlightPost(t):(o.$router.replace({name:"thread-post",params:{post_number:t}}),o.loadInitialPosts())};e?this.axios.get("/api/v1/post/"+t).then(function(t){return s(t.data.postNumber)}):s(t)},scrollTo:function(t,e){var o=this;this.$nextTick(function(){for(var s=function(t){var e=o.$refs.posts[t].$el.getBoundingClientRect().top,s=o.$refs.title.getBoundingClientRect().height;return window.pageYOffset+e-s-32},n=function(t){var n=o.posts[t];window.scrollTo(0,s(t)),e&&e(t,n)},i=0;i<o.posts.length;i++)if(o.posts[i].postNumber===t){o.$refs.posts?n(i):o.$nextTick(function(t){return n(i)});break}})},highlightPost:function(t){var e=this;this.scrollTo(t,function(o){e.highlightedPostIndex=o,e.$router.replace({name:"thread-post",params:{post_number:t}}),e.highlightedPostIndex===o&&setTimeout(function(){return e.highlightedPostIndex=null},3e3)})},showPostNotification:function(t){var e=this;t.username!==this.$store.state.username&&(this.$store.commit("thread/setPostNotification",null),this.$store.commit("thread/setPostNotification",t),setTimeout(function(t){e.$store.commit("thread/setPostNotification",null)},5e3))},goToPostNotification:function(){var t=this.$store.state.thread.postNotification;this.goToPost(t.postNumber),this.$store.commit("thread/setPostNotification",null)}},watch:{"$route.params.id":"loadInitialPosts"},mounted:function(){var t=this,e=this,o=function(){if(e.$refs.posts){var t=e.$refs.posts.sort(function(t,e){return t.post.postNumber-e.post.postNumber}),o=t.find(function(t){var e=t.$el.getBoundingClientRect();return e.top>=74&&e.bottom<=window.innerHeight}),s=t.indexOf(o);if(s>-1){var n=e.posts[s].postNumber;e.$router.replace({name:"thread-post",params:{post_number:n}})}}};document.addEventListener("scroll",Q()(o,20)),this.loadInitialPosts(),socket.emit("join","thread/"+this.$route.params.id),socket.on("new post",function(e){t.showPostNotification(e),t.$store.dispatch("loadNewPostsSinceLoad",e)}),Object(V["a"])("thread",this.$route.params.id)},destroyed:function(){socket.emit("leave","thread/"+this.$route.params.id),socket.off("new post")}},z=W,G=(o("59bf"),Object(p["a"])(z,s,n,!1,null,"2ec97068",null));G.options.__file="Thread.vue";e["default"]=G.exports},a760:function(t,e,o){},b4cf:function(t,e,o){"use strict";var s=o("cdfd"),n=o.n(s);n.a},c67e:function(t,e,o){},cdfd:function(t,e,o){},da16:function(t,e,o){"use strict";var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("modal-window",{attrs:{value:t.showModal},on:{input:t.setShowModal}},[o("div",{staticStyle:{"padding-top":"1rem"},attrs:{slot:"main"},slot:"main"},[t._t("default")],2),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("button",{staticClass:"button button--modal",class:t.buttonColor,on:{click:t.confirm}},[t._v(t._s(t.text||"OK"))]),o("button",{staticClass:"button button--modal",on:{click:function(e){t.setShowModal(!1)}}},[t._v("Cancel")])])])},n=[],i=o("6307"),r={name:"ConfirmModal",props:["value","color","text"],components:{ModalWindow:i["a"]},data:function(){return{showModal:!1}},computed:{buttonColor:function(){return this.color?"button--"+this.color:""}},watch:{value:function(t){this.showModal=t}},methods:{setShowModal:function(t){this.showModal=t,this.$emit("input",t)},confirm:function(){this.$emit("confirm"),this.setShowModal(!1)}},mounted:function(){this.setShowModal(this.value)}},a=r,c=o("2877"),u=Object(c["a"])(a,s,n,!1,null,null,null);u.options.__file="ConfirmModal.vue";e["a"]=u.exports},e7da:function(t,e,o){},ee7b:function(t,e,o){"use strict";var s=o("f784"),n=o.n(s);n.a},f784:function(t,e,o){}}]);
//# sourceMappingURL=chunk-1c3044d0.8210013d.js.map